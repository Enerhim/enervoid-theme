{{ define "main" }}
<div class="grid grid-cols-12 gap-8">
  <!-- TOC -->
  <aside class="hidden lg:block col-span-3">
    <div class="sticky top-24">
      <div class="mb-3 text-xs uppercase tracking-widest text-gray-500">Table of contents</div>

      {{- if .TableOfContents -}}
      <nav class="toc border border-gray-800/70 bg-[#070709] rounded-sm p-4 text-base text-gray-300">
        {{ .TableOfContents }}
      </nav>
      {{- else -}}
      <div class="border border-gray-800/70 bg-[#070709] rounded-sm p-4 text-base text-gray-500">
        No headings.
      </div>
      {{- end -}}
    </div>
  </aside>

  <!-- Main -->
  <article class="col-span-12 lg:col-span-9">
    {{ partial "article/meta.html" . }}

    <!-- Mobile TOC -->
    <div class="lg:hidden mb-6">
      <details class="border border-gray-800/70 bg-[#070709] rounded-sm">
        <summary class="cursor-pointer select-none px-4 py-3 text-gray-200 hover:text-white transition-colors">
          Table of contents
        </summary>
        <div class="px-4 pb-4 toc text-base text-gray-300">
          {{ .TableOfContents }}
        </div>
      </details>
    </div>

    <div class="border border-gray-800/70 bg-[#070709] rounded-sm p-5 sm:p-7">

      <div class="md-content text-lg sm:text-xl leading-relaxed text-gray-200">
        {{ .Content }}
      </div>
    </div>
  </article>
</div>

<style>
  .toc {
    font-size: 0.95rem;
    line-height: 1.35;
  }

  .toc ul {
    list-style: none;
    margin: 0;
    padding-left: 0;
  }

  .toc li {
    position: relative;
    margin: 0.35rem 0;
    padding-left: 1.25rem;
    /* room for symbols */
    overflow-wrap: anywhere;
    /* long headings won't collide */
    word-break: break-word;
  }

  .toc a {
    display: block;
    /* gives wrapped lines their own space */
    padding: 0.15rem 0;
    color: rgba(209, 213, 219, 0.92);
    text-decoration: none;
  }

  .toc a:hover {
    color: #fff;
    text-decoration: underline;
    text-decoration-color: rgba(99, 102, 241, 0.85);
    text-underline-offset: 3px;
  }

  /* Nesting rail + indentation */
  .toc ul ul {
    margin: 0.4rem 0 0.4rem 0.35rem;
    padding-left: 0.9rem;
    border-left: 1px solid rgba(55, 65, 81, 0.6);
  }

  .toc ul ul>li {
    padding-left: 1.75rem;
  }

  /* Symbols that don't overlap wrapped text */
  .toc ul ul>li::before {
    content: "├";
    position: absolute;
    left: 0.35rem;
    top: 0.2rem;
    /* aligns with first line, not center */
    color: rgba(99, 102, 241, 0.75);
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }

  .toc ul ul>li:last-child::before {
    content: "└";
  }

  /* Optional: keep TOC usable on very long posts */
  @media (min-width: 1024px) {
    .toc {
      max-height: calc(100vh - 9rem);
      overflow: auto;
      padding-right: 0.25rem;
    }
  }


  /* Lists */
  .md-content ul,
  .md-content ol {
    margin: 1rem 0;
    padding-left: 1.35rem;
  }

  .md-content ul {
    list-style: disc;
  }

  .md-content ul ul {
    list-style: circle;
  }

  .md-content ul ul ul {
    list-style: square;
  }

  .md-content ol {
    list-style: decimal;
  }

  .md-content ol ol {
    list-style: lower-roman;
  }

  .md-content ol ol ol {
    list-style: lower-alpha;
  }

  .md-content li {
    margin: 0.35rem 0;
  }

  /* “Tabbed spaces” in markdown content */
  .md-content pre,
  .md-content code {
    tab-size: 4;
  }
</style>
{{ end }}
